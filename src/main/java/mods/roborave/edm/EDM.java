package mods.roborave.edm;
import java.util.Arrays;

import mods.roborave.edm.common.CommonProxy;
import mods.roborave.edm.config.Config;
import mods.roborave.edm.helper.LogHandler;
import mods.roborave.edm.helper.VersionChecker;
import mods.roborave.edm.init.Blocks;
import mods.roborave.edm.interfaces.IMod;
import mods.roborave.edm.lib.Reference;
import mods.roborave.edm.lib.Strings;
import mods.roborave.edm.server.command.EDMCommand;
import mods.roborave.edm.tick.TickHandler;
import net.minecraft.creativetab.CreativeTabs;

import com.google.common.eventbus.Subscribe;

import cpw.mods.fml.common.Mod;
import cpw.mods.fml.common.Mod.EventHandler;
import cpw.mods.fml.common.Mod.Instance;
import cpw.mods.fml.common.Mod.Metadata;
import cpw.mods.fml.common.ModMetadata;
import cpw.mods.fml.common.SidedProxy;
import cpw.mods.fml.common.event.FMLInitializationEvent;
import cpw.mods.fml.common.event.FMLPostInitializationEvent;
import cpw.mods.fml.common.event.FMLPreInitializationEvent;
import cpw.mods.fml.common.event.FMLServerStartingEvent;

@Mod(modid = Strings.MODID, name = Strings.name, version = Strings.version)

public class EDM
{
	public String acutalMCversion= "1.7.2";
	
	@SidedProxy
	(
			clientSide="mods.roborave.edm.client.ClientProxy",
			serverSide="mods.roborave.edm.common.CommonProxy"
	)
	public static CommonProxy proxy;
	
	private Blocks blocks;
	
	private LogHandler logger = new LogHandler();
	
	private Strings library;
	
	public static CreativeTabs tabEDMBlock;
	public static CreativeTabs tabEDMItems;
	
	@IMod(Modid = "EDM", id = 1, name = "EDM")
	
	@Metadata(Strings.MODID)
	public ModMetadata meta;

	public String regenKey = "DISABLED";

	private mods.roborave.edm.helper.ore.Config config;
	@Instance(Strings.MODID)
	public static EDM Instance;
	
	public Strings getString()
	{
		return library;
	}
	public LogHandler getLogger()
	{
		return logger;
	}
	public Blocks getBlock()
	{
		return blocks;
		
	}
	 public static TickHandler tickHandler = new TickHandler();
	@EventHandler
	public void PreInit(FMLPreInitializationEvent event)
	{
		
		meta = event.getModMetadata();
		meta.autogenerated = false;
		meta.credits = "(C) Roborave, 2013-2014";
		meta.authorList = Arrays.asList("Roborave");
		meta.name = Strings.name;
		meta.version = Strings.version;
		meta.modId="Extra_Diamonds_Mod";
		
		proxy.PreInit();
		VersionChecker.registerMod(meta);
		
		Reference.config = new Config(event.getSuggestedConfigurationFile());
		Reference.config.load();
		Reference.config.save();
		
		mods.roborave.edm.helper.ore.Config.init(event);
		mods.roborave.edm.helper.ore.Config.load();
		EDM.Instance.getLogger().info("Registering Ore Generators");
		mods.roborave.edm.helper.ore.Config.save();
		EDM.Instance.getLogger().info(IMod.class.getMethods().toString());
		
    }
	
	@EventHandler
	public void Init(FMLInitializationEvent event)
	{
	
	proxy.loadMod();
	proxy.registerRenderThings();
	
	if(Reference.config.checkForUpdates()) 
	{
		VersionChecker.startVersionCheck();
	}

	proxy.registerTickers();
	
	}
	
	@EventHandler
	public void PostInit(FMLPostInitializationEvent event)
	{
		
	}
	
	@EventHandler
	public void serverStarting(FMLServerStartingEvent evt)
	{
		 evt.registerServerCommand(new EDMCommand(evt.getServer()));
	}
	public mods.roborave.edm.helper.ore.Config getConfig() 
	{
		return config;
	}
	public void setConfig(mods.roborave.edm.helper.ore.Config config) 
	{
		this.config = config;
	}

	
	
}
